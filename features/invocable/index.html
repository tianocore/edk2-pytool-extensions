<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Invocables - Tianocore Edk2 Pytool Extensions (edk2toolext)</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Invocables";
        var mkdocs_page_input_path = "features\\invocable.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Tianocore Edk2 Pytool Extensions (edk2toolext)
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Our Philosophy</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Using Stuart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../using/install/">Installation Instructions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../using/build/">Build Instructions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../using/ci/">Core CI Instructions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Integrating Stuart</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../integrate/build/">Build with Stuart</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../integrate/manage/">Core CI with Stuart</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../integrate/porting/">Porting Example</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Tools</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/using_capsule_tool/">Capsule Helper and Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/using_firmware_policy_tool/">Firmware Policy Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/using_image_validation_tool/">PE/COFF Image Validation Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/using_nuget_publishing_tool/">Nuget Publishing Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/using_omnicache_tool/">Omnicache Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/using_sig_db_tool/">Secure Boot Database Inspection Tool</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../tools/using_versioninfo_tool/">Version Info Tool</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced Features</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Invocables</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#base_abstract_invocable">base_abstract_invocable</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#provided-functions">provided functions</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#invoke">Invoke</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#configurelogging">ConfigureLogging</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#abstract-functions">abstract functions</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#edk2_invocable">edk2_invocable</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#functions">functions</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#parsecommandlineoptions">ParseCommandLineOptions</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#getsettingsclass">GetSettingsClass</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../creating_invocable/">Creating Invocables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../extdep/">Ext Deps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../creating_extdep/">Creating Ext Deps</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../plugin_manager/">Plugins</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../creating_plugins/">Create a Plugin</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../environment_variables/">Environment Variables</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sde/">Self Describing Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../settings_manager/">Settings Manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../logging/">Logging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../using_linux/">WSL</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/base_abstract_invocable/">Base abstract invocable</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/edk2_git/">Edk2 git</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/edk2_invocable/">Edk2 invocable</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/edk2_logging/">Edk2 logging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/conf_mgmt/">Conf mgmt</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/environment_descriptor_files/">Environment descriptor files</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/external_dependency/">External dependency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/multiple_workspace/">Multiple workspace</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/plugin_manager/">Plugin manager</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/repo_resolver/">Repo resolver</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/self_describing_environment/">Self describing environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/shell_environment/">Shell environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/uefi_build/">Uefi build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/var_dict/">Var dict</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/version_aggregator/">Version aggregator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/extdeptypes/az_cli_universal_dependency/">Az cli universal dependency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/extdeptypes/git_dependency/">Git dependency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/extdeptypes/nuget_dependency/">Nuget dependency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/extdeptypes/web_dependency/">Web dependency</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/plugintypes/ci_build_plugin/">Ci build plugin</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/plugintypes/dsc_processor_plugin/">Dsc processor plugin</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/plugintypes/uefi_build_plugin/">Uefi build plugin</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/environment/plugintypes/uefi_helper_plugin/">Uefi helper plugin</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/invocables/edk2_ci_build/">Edk2 ci build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/invocables/edk2_ci_setup/">Edk2 ci setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/invocables/edk2_multipkg_aware_invocable/">Edk2 multipkg aware invocable</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/invocables/edk2_platform_build/">Edk2 platform build</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/invocables/edk2_pr_eval/">Edk2 pr eval</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/invocables/edk2_setup/">Edk2 setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../api/invocables/edk2_update/">Edk2 update</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Tianocore Edk2 Pytool Extensions (edk2toolext)</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Advanced Features &raquo;</li>
      <li>Invocables</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/tianocore/edk2-pytool-extensions/edit/master/docs/features/invocable.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="invocables">Invocables<a class="headerlink" href="#invocables" title="Permanent link">&para;</a></h1>
<p>Invocables exist as a way to setup the EDK2 environment in a consistent way such that any script could be run in the
context of a UEFI environment. The base_abstract_invocable describes the necessities of the EDK2 environment, to be
provided by the user however they wish. Built on top of that, edk2_invocable is an attempt to do as much parsing and
setup for the user as possible to minimize the requirements of individual invocable scripts.</p>
<p>To kick off a script, just Invoke().</p>
<h2 id="base_abstract_invocable">base_abstract_invocable<a class="headerlink" href="#base_abstract_invocable" title="Permanent link">&para;</a></h2>
<p>example: Sample_InvocableHelloWorld.py</p>
<h3 id="provided-functions">provided functions<a class="headerlink" href="#provided-functions" title="Permanent link">&para;</a></h3>
<h4 id="invoke">Invoke<a class="headerlink" href="#invoke" title="Permanent link">&para;</a></h4>
<p>Main function. Parses command line options, configures logging, bootstraps environment, loads plugins, and finally
calls Go.</p>
<h4 id="configurelogging">ConfigureLogging<a class="headerlink" href="#configurelogging" title="Permanent link">&para;</a></h4>
<p>Sets up logging using information from GetWorkspaceRoot, GetLoggingLevel, GetLoggingFileName, and GetLoggingFolderRelativeToRoot.</p>
<h3 id="abstract-functions">abstract functions<a class="headerlink" href="#abstract-functions" title="Permanent link">&para;</a></h3>
<p>ParseCommandLineOptions is your opportunity to use argparser or look at sys.argv before kicking off setup.
If the environment isn't meant to be verifiable (maybe this script involves setting up or unpacking the environment),
GetVerifyCheckRequired can return False to bypass that step.
After that, GetWorkspaceRoot and GetActiveScopes is used to get the necessary information about the environment and set
everything up. Go will be called after all that setup.</p>
<p>Note: logging before ConfigureLogging gets called causes logging to be setup twice (once implicitly by calling it early
and then again by ConfigureLogging) and you will see duplicate messages in your console. To avoid this, do not log in
ParseCommandLineOptions, GetLoggingLevel, GetWorkspaceRoot, GetLoggingFolderRelativeToRoot, or GetLoggingFileName.
If you must have output, use print() or log another way.</p>
<h2 id="edk2_invocable">edk2_invocable<a class="headerlink" href="#edk2_invocable" title="Permanent link">&para;</a></h2>
<p>Example: edk2toolext\invocables\edk2_update.py</p>
<p>Basically just base_abstract_invocable + settings parsing.</p>
<h3 id="functions">functions<a class="headerlink" href="#functions" title="Permanent link">&para;</a></h3>
<h4 id="parsecommandlineoptions">ParseCommandLineOptions<a class="headerlink" href="#parsecommandlineoptions" title="Permanent link">&para;</a></h4>
<p>This is implemented for the user. It requires a Python settings file be provided. After importing the settings file,
another argparser is created, which is passed to the invoking script and to the settings file. Additionally, key value
pairs in the format <code>KEY=VALUE</code> will be read into the build environment, accessible by calling
<code>shell_environment.GetBuildVars().GetValue(KEY)</code>. For example, to skip loading the compiler plugin, pass
<code>CompilerPlugin=skip</code> as an extra argument when calling your script.</p>
<h4 id="getsettingsclass">GetSettingsClass<a class="headerlink" href="#getsettingsclass" title="Permanent link">&para;</a></h4>
<p>This must provide a Python class that edk2_invocable can expect to find instantiated by your settings script.</p>
<h5 id="multi-inheritance">multi inheritance<a class="headerlink" href="#multi-inheritance" title="Permanent link">&para;</a></h5>
<p>Example: NXP</p>
<p>In Python it is allowed and it will be helpful for you as long as you don't try to get too creative with it.
GetActiveScopes, GetWorkspaceRoot, AddCommandLineOptions, RetrieveCommandLineOptions are required to be in each
Settings class. Using a platform as an example, PlatformSetup, Update, and PlatformBuild all require settings classes,
but they can all be provided by the same implementation with multi-inherence.
The caveat is that you will not know which parent class is invoking you.
If that is required, it will be necessary to break that settings class out into it's own class.
It is also worth noting that multiple classes can live in the same file and the correct one will still be located by the
loading logic.</p>
<p>In the PlatformBuild scenario, it is even possible to have UefiBuilder, UpdateSettingsManager, SetupSettingsManager,
and BuildSettingsManager all in one class.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../tools/using_versioninfo_tool/" class="btn btn-neutral float-left" title="Version Info Tool"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../creating_invocable/" class="btn btn-neutral float-right" title="Creating Invocables">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
      <p>Copyright (c) Microsoft.  All rights reserved</p>
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/tianocore/edk2-pytool-extensions" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../tools/using_versioninfo_tool/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../creating_invocable/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme_extra.js" defer></script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://unpkg.com/mermaid@8.7.0/dist/mermaid.min.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
